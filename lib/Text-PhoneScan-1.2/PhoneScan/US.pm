package Text::PhoneScan::US;
use base 'Text::PhoneScan::Scanner';
my $extension_suffix = __PACKAGE__->extension_suffix;
my $exchanges =
qr/(?:2(?:0[123456789]|1[023456789]|2[4589]|3[149]|4[0268]|5[012346]|6[024789]|7[06]|8[149])|3(?:0[123456789]|1[023456789]|2[013]|3[04679]|4[057]|5[12]|6[01]|86)|4(?:0[123456789]|1[023456789]|2[35]|3[45]|4[013]|50|69|7[0389]|8[04])|5(?:0[123456789]|1[023456789]|20|30|4[01]|5[19]|6[1237]|7[0134]|8[056])|6(?:0[123456789]|1[023456789]|2[036]|3[016]|4[1679]|5[01]|6[0124]|7[018]|82)|7(?:0[123456789]|1[23456789]|2[047]|3[124]|40|5[478]|6[0357]|7[023458]|8[014567])|8(?:0[0123456789]|1[023456789]|28|3[012]|4[3578]|5[06789]|6[023456789]|7[0678]|88)|9(?:0[123456789]|1[023456789]|2[058]|3[1679]|4[0179]|5[246]|7[012389]|8[059]))/ox;
my $usphone_prefix = qr/(?:1[-\.])?(?:\($exchanges\)|$exchanges)/;
my $usphone_suffix = qr/\s*[\dA-Z]{3}[-\.\s]+[\dA-Z]{4,}
                       |\s*[A-Z]{2}[-\.\s]+[A-Z]{5,}
                       |\s*[A-Z]{4}[-\.\s]+[A-Z]{3,}/x;
my $usphone = qr/$usphone_prefix(?:)[\.-]?$usphone_suffix$extension_suffix/;

sub scan { 
    my @rv;
    push @rv, $1 
        while $_[1]->{text} =~ s/(?:\b|^)($usphone)(\b|$)//;
    return @rv;
}
1;

